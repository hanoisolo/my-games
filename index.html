<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lucky Grid Pick - Departure Time!</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            background-color: #f4f4f4;
            color: #333;
        }

        h1 {
            color: #0056b3;
        }

        #instructions {
            margin-bottom: 15px;
            font-style: italic;
        }

        #turn-indicator {
            font-size: 1.2em;
            font-weight: bold;
            margin-bottom: 20px;
            min-height: 1.5em; /* Prevent layout shift */
            color: #d9534f;
        }

        #grid-container {
            display: grid;
            /* Adjust columns based on how many squares you want */
            grid-template-columns: repeat(4, 100px); /* 4 columns wide */
            gap: 10px;
            margin-bottom: 20px;
        }

        .grid-square {
            width: 100px;
            height: 100px;
            background-color: #5bc0de;
            border: 2px solid #46b8da;
            border-radius: 8px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.1em;
            font-weight: bold;
            color: white;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.2s;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.4);
            user-select: none; /* Prevent text selection */
        }

        .grid-square:not(.revealed):hover {
            background-color: #31b0d5;
            transform: scale(1.05);
        }

        .grid-square.revealed {
            background-color: #f0ad4e; /* Orange when revealed */
            border-color: #eea236;
            color: #fff;
            cursor: default;
            transform: scale(1); /* Back to normal size */
            font-size: 1.2em; /* Make time slightly larger */
        }

        #reset-button {
            padding: 10px 20px;
            font-size: 1em;
            color: white;
            background-color: #0275d8;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        #reset-button:hover {
            background-color: #025aa5;
        }
    </style>
</head>
<body>

    <h1>Lucky Grid Pick!</h1>
    <p id="instructions">Click a square to reveal your departure time!</p>
    <div id="turn-indicator">Loading...</div>

    <div id="grid-container">
        <!-- Squares will be generated by JavaScript -->
    </div>

    <button id="reset-button">Reset Game</button>

    <script>
        const players = ['Dee', 'Anokhi', 'Seema', 'Bruce'];
        const gridContainer = document.getElementById('grid-container');
        const turnIndicator = document.getElementById('turn-indicator');
        const resetButton = document.getElementById('reset-button');
        const numberOfSquares = 12; // e.g., 4x3 grid

        let currentPlayerIndex = 0;
        let assignedTimes = {}; // Keep track of who got what
        let hiddenTimes = [];

        // --- Core Functions ---

        // Generate the pool of times
        function generateTimes(count) {
            const baseTimes = [
                "5:20 PM", "5:21 PM", "5:22 PM", "5:23 PM", "5:24 PM",
                "5:25 PM", "5:26 PM", "5:27 PM", "5:28 PM", "5:29 PM", "5:30 PM"
            ];
            let timesPool = [];
            // Ensure at least one of each base time if possible, then fill randomly
            for (let i = 0; i < count; i++) {
                // Simple approach: just pick randomly from the base times
                // This might lead to duplicates easily, which is fine for this game.
                const randomIndex = Math.floor(Math.random() * baseTimes.length);
                timesPool.push(baseTimes[randomIndex]);
            }

            // Ensure some early times are definitely present for a 12-grid example
            timesPool[0] = "5:20 PM";
            timesPool[1] = "5:21 PM";
            timesPool[2] = "5:22 PM";
            timesPool[3] = "5:23 PM";

            return timesPool;
        }


        // Fisher-Yates (Knuth) Shuffle Algorithm
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]]; // Swap elements
            }
        }

        // Create the grid squares
        function createGrid() {
            gridContainer.innerHTML = ''; // Clear previous grid
            hiddenTimes = generateTimes(numberOfSquares);
            shuffleArray(hiddenTimes);

            for (let i = 0; i < hiddenTimes.length; i++) {
                const square = document.createElement('div');
                square.classList.add('grid-square');
                square.dataset.index = i; // Store index if needed
                square.dataset.time = hiddenTimes[i]; // Store the time secretly
                square.textContent = '?'; // Initial display
                square.setAttribute('role', 'button'); // Accessibility
                square.setAttribute('aria-label', 'Hidden time square');
                square.addEventListener('click', handleSquareClick);
                gridContainer.appendChild(square);
            }
        }

        // Update the display showing whose turn it is
        function updateTurnIndicator() {
            if (currentPlayerIndex < players.length) {
                turnIndicator.textContent = `${players[currentPlayerIndex]}'s turn! Pick a square.`;
            } else {
                turnIndicator.textContent = "All players have picked! Game over.";
                // Optionally display final results here
                 displayResults();
            }
        }

        // Handle clicking on a square
        function handleSquareClick(event) {
            const square = event.target;

            // Ignore if already revealed or if game is over for player assignment
            if (square.classList.contains('revealed') || currentPlayerIndex >= players.length) {
                return;
            }

            const revealedTime = square.dataset.time;
            const currentPlayerName = players[currentPlayerIndex];

            // Reveal the time
            square.textContent = revealedTime;
            square.classList.add('revealed');
            square.removeEventListener('click', handleSquareClick); // Prevent re-clicking logic
            square.style.cursor = 'default'; // Change cursor
            square.setAttribute('aria-label', `Revealed time: ${revealedTime}`);


            // Store the result
            assignedTimes[currentPlayerName] = revealedTime;
            console.log(`${currentPlayerName} gets to leave at ${revealedTime}`);

            // Move to the next player
            currentPlayerIndex++;
            updateTurnIndicator();
        }

        // Optional: Display final assigned times
        function displayResults() {
            let resultsHTML = "<h3>Final Times:</h3><ul>";
            for(const player of players) {
                resultsHTML += `<li>${player}: ${assignedTimes[player] || 'Did not pick yet'}</li>`;
            }
            resultsHTML += "</ul>";
            // You could append this somewhere, maybe below the grid
             // Example: turnIndicator.insertAdjacentHTML('afterend', resultsHTML);
             console.log("Final Times:", assignedTimes);
        }


        // Reset the game state
        function resetGame() {
            currentPlayerIndex = 0;
            assignedTimes = {};
            createGrid();
            updateTurnIndicator();
            console.log("Game Reset!");
            // Remove old results if they were displayed
        }

        // --- Initialization ---
        resetButton.addEventListener('click', resetGame);
        // Initial game setup on load
        resetGame();

    </script>

</body>
</html>
